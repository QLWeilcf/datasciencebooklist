

### 书单列表


|书名|分类|作者|出版年|推荐星级|页数|出版社|豆瓣评分|是否读完|
|---|---|---|---|---|---|---|---|---|
|数据化管理|思维及业务|黄成明|2014-7|★★★★★|306|电子工业出版社|[8.4](https://book.douban.com/subject/25909355/)|a|
|活用数据|思维及业务|陈哲|2019-2|★★★★★|216|电子工业出版社|[7.9](https://book.douban.com/subject/30468651/)|a|
|数据化运营速成手册|思维及业务|胡晨川|2017-4|★★★★|268|电子工业出版社|[7.9](https://book.douban.com/subject/27034727/)|a|
|金字塔原理|思维及业务|[美]巴巴拉·明托|2010-8|★★★★★|290|民主与建设出版社|[8.1](https://book.douban.com/subject/1020644/)|a|
|谁说菜鸟不会数据分析（入门篇）|思维及业务|张文霖|2013-1|★★★★|248|电子工业出版社|[7.5](https://book.douban.com/subject/20373356/)|b|
|从零开始做运营|思维及业务|张亮|2015-11|★★★★☆|334|中信出版社|[7.4](https://book.douban.com/subject/26682111/)|c|
|数据分析：企业的贤内助|思维及业务|陈哲|2013-10|★★★★☆|332|机械工业出版社|[8.1](https://book.douban.com/subject/25743117/)|b|
|我不是产品经理|思维及业务|岳建雄主编|2019-5|★★★★☆|292|电子工业出版社|[6.9](https://book.douban.com/subject/33417653/)|d|
|商务与经济统计学|统计学|特里·辛西奇|2015-2|★★★★★|512|中国人民大学出版社|[8.5](https://book.douban.com/subject/26410924/)|b|
|程序员的数学2：概率统计|统计学|平冈和幸|2015-8|★★★★☆|405|人民邮电出版社|[8.7](https://book.douban.com/subject/26593822/)|a|
|统计学：从数据到结论|统计学|吴喜之|2013-3|★★★★☆|219|中国统计出版社|[8.2](https://book.douban.com/subject/24316364/)|a|
|鲜活的数据|集成可视化|[美]NathanYau|2012-10|★★★★|281|人民邮电出版社|[7.4](https://book.douban.com/subject/19952397/)|a|
|Excel仪表盘实战|集成可视化|姜辉|2019-1|★★★★☆|256|电子工业出版社|[nan](https://book.douban.com/subject/30413623/)|a|
|数据可视化实战：使用D3设计交互式图表|编程可视化|[美] Scott Murray|2013-6|★★★★★|7|人民邮电出版社|[7.5](https://book.douban.com/subject/24748670/)|a|
|R语言数据可视化之美|工具-R|张杰|2019-6|★★★★|292|电子工业出版社|[暂无评分](https://book.douban.com/subject/33459886/)|c|
|别怕，Excel VBA其实很简单|工具-Excel|ExcelHome|2012-10|★★★★☆|314|人民邮电出版社|[8.1](https://book.douban.com/subject/19952184/)|a|
|对比excel，轻松学习Python数据分析|工具-Python|张俊红|2019-2|★★★★★|284|电子工业出版社|[7.5](https://book.douban.com/subject/30443577/)|a|
|Python数据分析与挖掘实战|工具-Python|苏剑林|2016-1|★★★★☆|335|机械工业出版社|[7.6](https://book.douban.com/subject/26677686/)|a|
|Python数据科学手册|工具-Python|JakeVanderPlas|2018-1|★★★★|468|人民邮电出版社|[9.3](https://book.douban.com/subject/27667378/)|a|
|利用Python进行数据分析|工具-Python|WesMcKinney|2013-11|★★★★☆|464|机械工业出版社|[8.6](https://book.douban.com/subject/25779298/)|a|
|Python编程快速上手|工具-Python|AlbertSweigart|2016-7|★★★★|391|人民邮电出版社/异步图书|[9.0](https://book.douban.com/subject/26836700/)|a|
|R语言实战|工具-R|卡巴科弗|2013-1|★★★★☆|388|人民邮电出版社|[8.8](https://book.douban.com/subject/20382244/)|a|
|菜鸟侦探挑战数据分析|工具-R|[日]石田基广|2017-1|★★★★★|264|人民邮电出版社|[8.4](https://book.douban.com/subject/26953724/)|a|
|Julia数据科学应用|工具-Julia|[美]扎卡赖亚斯·弗格里斯|2018-2|★★★★☆|286|人民邮电出版社|[nan](https://book.douban.com/subject/30292811/)|a|
|PPT练成记|工具-PPT|曹将|2014-5|★★★★|303|中国青年出版社|[8.3](https://book.douban.com/subject/25852784/)|a|
|七周七数据库|SQL|[美]EricRedmond|2013-5|★★★★|256|人民邮电出版社|[7.1](https://book.douban.com/subject/24737847/)|a|
|SQL必知必会|SQL|福达(BenForta)|2013-5|★★★★|239|人民邮电出版社|[8.5](https://book.douban.com/subject/24250054/)|a|
|MySQL必知必会|SQL|[英]BenForta|2009-1|★★★★|241|人民邮电出版社|[8.4](https://book.douban.com/subject/3354490/)|a|
|大话数据结构|CS算法|程杰|2011-6|★★★★☆|440|清华大学出版社|[7.9](https://book.douban.com/subject/6424904/)|a|
|算法新解|CS算法|刘新宇|2016-12|★★★★☆|566|人民邮电出版社|[9.3](https://book.douban.com/subject/26931430/)|a|
|图解机器学习|挖掘算法|杉山将|2015-4|★★★★|240|人民邮电出版社|[6.3](https://book.douban.com/subject/26363531/)|a|
|精通数据科学：从线性回归到深度学习|挖掘算法|唐亘|2018-5|★★★★☆|432|人民邮电出版社|[7.1](https://book.douban.com/subject/30217266/)|a|
|数据挖掘导论|挖掘算法|VipinKumar|2010-12|★★★★★|463|人民邮电出版社|[8.2](https://book.douban.com/subject/5377669/)|a|
|用商业案例学R语言数据挖掘|挖掘算法|朱江|2017-9|★★★★|460|电子工业出版社|[nan](https://book.douban.com/subject/27099217/)|a|
|机器学习实战|挖掘算法|PeterHarrington|2013-6|★★★★|332|人民邮电出版社|[8.1](https://book.douban.com/subject/24703171/)|a|
|数据挖掘概念与技术|挖掘算法|[加)Jiawei Han|2007-3|★★★★|488|机械工业出版社|[7.7](https://book.douban.com/subject/2038599/)|a|
|Python 3网络爬虫开发实战|数据获取|崔庆才|2018-4|★★★★|608|人民邮电出版社|[9](https://book.douban.com/subject/30175598/)|a|
|Python网络数据采集|数据获取|[美]米切尔|2016-3|★★★☆|200|人民邮电出版社|[7.7](https://book.douban.com/subject/26740503/)|a|
|数据科学家访谈录|其他拓展|MaxSong（宋迈思）|2018-2|★★★★★|308|人民邮电出版社|[8.0](https://book.douban.com/subject/30129410/)|a|
|数学之美|其他拓展|[美]吴军|2012-5|★★★★|272|人民邮电出版社|[8.7](https://book.douban.com/subject/10750155/)|a|
|计算广告|其他拓展|王超|2015-9|★★★★|295|人民邮电出版社|[8.6](https://book.douban.com/subject/26596778/)|a|
|思考的乐趣|其他拓展|顾森|2012-6|★★★★★|266|人民邮电出版社|[8.2](https://book.douban.com/subject/10779597/)|a|
|浴缸里的惊叹|其他拓展|顾森|2014-7|★★★★★|228|人民邮电出版社|[8](https://book.douban.com/subject/25918542/)|a|
|硅谷增长黑客实战|其他拓展|曲卉|2018-4|★★★★|272|机械工业出版社|[9](https://book.douban.com/subject/30186119/)|c|
|囚徒健身|其他拓展|保罗·威德|2013-10|★★★★|264|北京科学技术出版社|[8.6](https://book.douban.com/subject/25717097/)|d|


以上书单不需要手动一条条整理，是通过以下代码直接生成的：

```python

import json
import requests
import pandas as pd
from lxml import etree

bdf=pd.read_excel('ds-bookslist-201912.xlsx')
bdf.head(2)

hrs={'Cookie': 'gr_user26=true',
    'Host': 'book.douban.com',
    'Referer': 'https://book.douban.com/subject/20773481/',
    'User-Agent': 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/69.0.3497.100 Safari/537.36'
    }

rlst=[]
for i,c in bdf.iterrows():
    bn=c['书名']
    try:
        r=requests.get('https://book.douban.com/j/subject_suggest?q={0}'.format(bn),headers=hrs)
        rj=json.loads(r.text)
        #对rj进行一下验证和筛选
        html=requests.get(rj[0]['url'],headers=hrs) #之后再考虑多个返回值的验证
        con = etree.HTML(html.text)
        bname=con.xpath('//*[@id="wrapper"]/h1/span/text()')[0] #和bn比较
        if bn!=bname:
            if bn in bname:
                pass
            elif bname in bn:
                pass
            else:
                print(bn,bname,rj[0]['url'])
                continue
        bdf.loc[i,'豆瓣书名']=bname
        bdf.loc[i,'豆瓣链接']=rj[0]['url']
    
        #这部分取到info就够了，之后再用高级方法去匹配需要的元素，目前对应不对
        binfo=con.xpath('//*[@id="info"]')
        cc=con.xpath('//*[@id="info"]/text()')
        bfo=getBookInfo(binfo,cc)  #调用上面的函数处理binfo
        bdf.loc[i,'作者']=bfo.get('作者')
        bdf.loc[i,'出版年']=bfo.get('出版年')
        bdf.loc[i,'出版社']=bfo.get('出版社')
        bdf.loc[i,'副标题']=bfo.get('副标题')
        bdf.loc[i,'页数']=bfo.get('页数')
        bdf.loc[i,'丛书']=bfo.get('丛书')
        bdf.loc[i,'ISBN']=bfo.get('ISBN')
        bmark=con.xpath('//*[@id="interest_sectl"]/div/div[2]/strong/text()')[0]
        if bmark=='  ':
            bits=con.xpath('//*[@id="interest_sectl"]/div/div[2]/div/div[2]/span/a/text()')[0]
            if bits=='评价人数不足':
                bdf.loc[i,'豆瓣评分']=''
                bdf.loc[i,'评价人数']='评价人数不足'
            else:
                bdf.loc[i,'豆瓣评分']=''
                bdf.loc[i,'评价人数']=''
        else:
            bdf.loc[i,'豆瓣评分']=bmark.replace(' ','')
            bmnum=con.xpath('//*[@id="interest_sectl"]/div/div[2]/div/div[2]/span/a/span/text()')[0]
            bdf.loc[i,'评价人数']=bmnum
        time.sleep(1)
    except Exception as e:
        print(i,bn,e)
        
def getBookInfo(binfo,cc):
    i=0
    rss={}
    k=''
    v=''
    f=0
    clw=[]
    for c in cc:
        if '\n' in c:
            if '\xa0' in c:
                clw.append(c)
        else:
            clw.append(c)
    
    for m in binfo[0]:
        if m.tag=='span':
            mlst=m.getchildren()
            if len(mlst)==0: 
                k=m.text.replace(':','')
                if '\xa0' in clw[i]:
                    f=1#需要m.tag=='a'下的值
                else:
                    v=clw[i].replace('\n','').replace(' ','')
                i+=1
            elif len(mlst)>0:#下面有子span 一种判断是m.attrib=={} 不够精确
                for n in mlst:
                    if n.tag=='span':
                        k=n.text.replace('\n','').replace(' ','') #不至于下面还有span，懒得用递归了
                    elif n.tag=='a':
                        v=n.text.replace('\n','').replace(' ','')
        
        elif m.tag=='a':
            if f==1: #是否可以不用这个if
                v=m.text.replace('\n','').replace(' ','')
                f=0
        elif m.tag=='br':
            if k=='':
                print(i,'err')
            else:
                rss[k]=v
        else:
            print(m.tag,i)
    return rss
bdf.to_excel('ds-bookslist-201912.xlsx')

#---
bdf=pd.read_excel('ds-bookslist-201912.xlsx')
def recommendStar(s):
    s1=int(s//1)
    if s>5:
        return '★'*5
    elif s1<=0:
        return ''
    elif s1==s:
        return '★'*s1
    else: #4.5等情况
        return '{0}☆'.format('★'*s1)
def yearOfPus(y):
    k=y.split('-')
    if len(k)>2:
        return '{0}-{1}'.format(k[0],k[1])
    return y
bdf['出版年']=bdf['出版年'].apply(yearOfPus)
bdf['推荐星级']=bdf['推荐星级'].apply(recommendStar)
bdf['页数']=bdf['页数'].astype('int')
bdf['豆瓣评分']=bdf.apply(lambda x:'[{0}]({1})'.format(x['豆瓣评分'],x['豆瓣链接']))
cols='书名 分类 作者 出版年 推荐星级 页数 出版社 豆瓣评分 是否已读完'.split()
df=bdf.reindex(columns=cols)
with open('ds-bookslist-201912.txt','w+') as wf:
    wf.write('书单列表：\n')
    wf.write('|{0}|\n'.format('|'.join(cols)))
    wf.write('|{0}|\n'.format('|'.join(['---' for _ in cols])))
    for i,c in df.iterrows():
        wf.write('|{0}|\n'.format('|'.join([str(j) for j in list(c)])))
```

